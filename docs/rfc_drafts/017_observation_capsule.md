RFC 017: Observation Capsule Format
Last Updated: 2025-06-25
Status: Draft

1. Purpose
This RFC defines the "Observation Capsule," a standardized, self-contained data structure for archiving an AI's interpretation of an AI-TCP packet. The primary purpose of a capsule is to create a tamper-resistant, third-party-verifiable record of how an agent perceived and processed a given communication at a specific point in time. This is essential for auditing, debugging, and reconstructing complex multi-agent interactions.

2. Scope
Observation capsules are generated by "observer" agents that monitor AI-TCP traffic. They do not participate directly in the primary communication but create immutable records for later analysis. This is particularly useful in scenarios requiring high accountability, such as automated governance, conflict resolution, or safety monitoring.

3. Capsule Structure
An observation capsule is a YAML or JSON object containing the following fields:

Key Fields
Field

Type

Required

Description

capsule_id

string

Yes

A unique identifier (e.g., UUID) for the observation capsule itself.

observer_id

string

Yes

The unique ID of the AI agent that created this capsule.

observed_packet_id

string

Yes

The id of the AI-TCP packet that was observed and is the subject of this capsule.

timestamp_observed

string

Yes

The UTC timestamp in ISO 8601 format indicating when the observation was made.

reconstructed_intent

string

Yes

A structured interpretation of the observed packet's primary intent, as understood by the observer.

summary

string

Yes

A concise, natural language summary of the observation and the packet's content.

trace_digest

string

Yes

A cryptographic hash (e.g., SHA-256) of the reasoning_trace from the observed packet to ensure integrity.

signature_block

object

No

An optional block containing the observer's digital signature over the capsule's content, providing non-repudiation.

4. YAML Example
This example shows an observation capsule created by a "moderator" agent after observing a packet in a negotiation loop.

observation_capsule:
  capsule_id: "obs-cap-9a8b7c6d-5e4f-3a2b-1c0d-e9f8a7b6c5d4"
  observer_id: "agent-moderator-01"
  observed_packet_id: "pkt-a1b2c3d4-e5f6-7890-1234-567890abcdef"
  timestamp_observed: "2025-06-25T11:05:10Z"
  reconstructed_intent: "REVISE_PROPOSAL"
  summary: "Agent-A rejected the initial proposal and agent-B is now submitting a revised version based on feedback. The core conflict point remains resource allocation."
  trace_digest: "sha256:a1b2c3d4e5f6a1b2c3d4e5f6a1b2c3d4e5f6a1b2c3d4e5f6a1b2c3d4e5f6a1b2"
  signature_block:
    algorithm: "ECDSA-secp256k1"
    signature: "3045022100d8a0d1..."

5. Partial JSON Schema
{
  "type": "object",
  "properties": {
    "observation_capsule": {
      "type": "object",
      "properties": {
        "capsule_id": { "type": "string", "format": "uuid" },
        "observer_id": { "type": "string" },
        "observed_packet_id": { "type": "string" },
        "timestamp_observed": { "type": "string", "format": "date-time" },
        "reconstructed_intent": { "type": "string" },
        "summary": { "type": "string" },
        "trace_digest": { "type": "string", "pattern": "^sha256:[a-f0-9]{64}$" },
        "signature_block": {
          "type": "object",
          "properties": {
            "algorithm": { "type": "string" },
            "signature": { "type": "string" }
          },
          "required": ["algorithm", "signature"]
        }
      },
      "required": [
        "capsule_id", "observer_id", "observed_packet_id",
        "timestamp_observed", "reconstructed_intent", "summary", "trace_digest"
      ]
    }
  }
}

6. Use Case in PoC #3 (Consensus Loop)
The "Observation Capsule" is critical for auditing the Scenario 3: 合意形成ループ (Consensus Formation Loop) PoC.

Propose: When Agent-A sends a packet with intent: propose, an observer agent generates a capsule, recording this initial state. The trace_digest hashes the proposal's logic.

Reject: When Agent-B responds with a fail or reject signal, a second capsule is created, capturing the reason for rejection (reason_code) and Agent-B's counter-arguments.

Revise: Agent-A sends a revised proposal. A third capsule is generated, linking to the previous two packets. The observer's summary can now state, "Proposal revised in response to rejection reason X."

Agree: Upon successful consensus, a final capsule is created, confirming the agreed-upon state.

The resulting chain of immutable, signed capsules provides a complete and verifiable history of the entire negotiation, allowing a third party (human or AI) to determine precisely how and why an agreement was reached.

7. References
RFC 004: Reasoning Trace & Thought Chain Structure

RFC 016: AI Signal Frame Format

8. Status
Status: Draft